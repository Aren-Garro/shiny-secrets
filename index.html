<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Scanner - Free Security Tool</title>
    <style>
        :root {
            --bg-1: #0f172a;
            --bg-2: #1e293b;
            --bg-3: #334155;
            --text-1: #f1f5f9;
            --text-2: #cbd5e1;
            --accent: #38bdf8;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: rgba(148, 163, 184, 0.2);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-1);
            color: var(--text-1);
            line-height: 1.6;
            padding: 20px;
        }

        .container { max-width: 1400px; margin: 0 auto; }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: var(--bg-2);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        h1 { font-size: 2.5rem; margin-bottom: 10px; color: var(--accent); }
        .subtitle { color: var(--text-2); font-size: 1.1rem; }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 968px) {
            .main-grid { grid-template-columns: 1fr; }
        }

        .card {
            background: var(--bg-2);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
        }

        .card h2 { margin-bottom: 16px; color: var(--accent); font-size: 1.5rem; }

        textarea {
            width: 100%;
            min-height: 300px;
            background: var(--bg-3);
            color: var(--text-1);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }

        textarea:focus { outline: 2px solid var(--accent); outline-offset: 2px; }

        .button-group { display: flex; gap: 12px; margin-top: 16px; flex-wrap: wrap; }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary { background: var(--accent); color: var(--bg-1); }
        .btn-primary:hover { background: #0ea5e9; transform: translateY(-1px); }
        .btn-secondary { background: var(--bg-3); color: var(--text-1); border: 1px solid var(--border); }
        .btn-secondary:hover { background: var(--bg-1); }

        .keyboard-hint { font-size: 13px; color: var(--text-2); margin-top: 8px; font-style: italic; }

        .results-section {
            background: var(--bg-2);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
            margin-top: 20px;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .result-stats { display: flex; gap: 20px; flex-wrap: wrap; }
        .result-actions { display: flex; gap: 12px; }

        .stat-badge { padding: 8px 16px; border-radius: 6px; font-weight: 600; font-size: 14px; }
        .stat-danger { background: rgba(239, 68, 68, 0.2); color: var(--danger); border: 1px solid var(--danger); }
        .stat-success { background: rgba(34, 197, 94, 0.2); color: var(--success); border: 1px solid var(--success); }
        .stat-warning { background: rgba(245, 158, 11, 0.2); color: var(--warning); border: 1px solid var(--warning); }

        .btn-copy { padding: 8px 16px; font-size: 14px; background: var(--bg-3); color: var(--text-1); border: 1px solid var(--border); }
        .btn-copy:hover { background: var(--bg-1); }
        .btn-copy.copied { background: var(--success); color: white; }

        .finding {
            background: var(--bg-3);
            border-left: 4px solid var(--danger);
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 6px;
        }

        .finding-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .finding-type { font-weight: 600; color: var(--danger); font-size: 14px; }
        .finding-line { color: var(--text-2); font-size: 13px; }

        .finding-content {
            background: var(--bg-1);
            padding: 12px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin-top: 8px;
        }

        .secret-highlight { background: rgba(239, 68, 68, 0.3); color: var(--danger); padding: 2px 4px; border-radius: 3px; }

        .severity-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 999px;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.03em;
        }

        .severity-critical { background: rgba(239, 68, 68, 0.2); color: #fca5a5; border: 1px solid var(--danger); }
        .severity-high { background: rgba(245, 158, 11, 0.2); color: #fcd34d; border: 1px solid var(--warning); }
        .severity-medium { background: rgba(56, 189, 248, 0.2); color: #7dd3fc; border: 1px solid var(--accent); }

        .pattern-list { display: grid; gap: 12px; margin-top: 16px; }
        .pattern-group { background: var(--bg-3); padding: 16px; border-radius: 8px; }
        .pattern-group-title { font-weight: 600; font-size: 15px; color: var(--accent); margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .pattern-group-icon { width: 10px; height: 10px; background: var(--accent); border-radius: 50%; }
        .pattern-items { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
        .pattern-tag { background: var(--bg-1); padding: 6px 12px; border-radius: 4px; font-size: 13px; color: var(--text-2); border: 1px solid var(--border); }

        .privacy-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(34, 197, 94, 0.15);
            color: var(--success);
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 12px;
        }

        .no-results { text-align: center; padding: 40px; color: var(--text-2); }
        .no-results svg { width: 64px; height: 64px; margin-bottom: 16px; opacity: 0.5; }

        .entropy-info { font-size: 12px; color: var(--text-2); margin-top: 4px; }
        .test-samples { margin-top: 16px; }
        .sample-btn { padding: 8px 16px; font-size: 14px; margin-right: 8px; margin-bottom: 8px; }

        .loading { display: none; text-align: center; padding: 20px; }
        .loading.active { display: block; }
        .spinner {
            border: 3px solid var(--bg-3);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 12px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .quickstart, .offline-usage { background: var(--bg-2); border-radius: 12px; padding: 24px; border: 1px solid var(--border); margin-top: 20px; }
        .quickstart h3, .offline-usage h3 { color: var(--accent); margin-bottom: 16px; }
        .quickstart-steps { display: grid; gap: 16px; }
        .step { display: flex; gap: 16px; }
        .step-number { width: 32px; height: 32px; background: var(--accent); color: var(--bg-1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; flex-shrink: 0; }
        .step-content { flex: 1; }
        .step-content h4 { margin-bottom: 6px; color: var(--text-1); }
        .step-content p { color: var(--text-2); font-size: 14px; }
        .code-block { background: var(--bg-3); padding: 12px; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 13px; overflow-x: auto; margin-top: 8px; border: 1px solid var(--border); }

        .footer { text-align: center; margin-top: 40px; padding: 20px; color: var(--text-2); font-size: 14px; }
        .footer a { color: var(--accent); text-decoration: none; }
        .footer a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Secret Scanner</h1>
            <p class="subtitle">Free open-source tool to detect hardcoded secrets and credentials in your code</p>
            <div class="privacy-badge">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                100% Client-Side ‚Ä¢ Zero Network Calls ‚Ä¢ Your Code Never Leaves Your Browser
            </div>
        </header>

        <div class="main-grid">
            <div class="card">
                <h2>Paste Your Code</h2>
                <textarea id="codeInput" placeholder="Paste your code, configuration files, or any text containing potential secrets...\n\nExample:\nconst AWS_KEY = 'AKIAIOSFODNN7EXAMPLE';\nconst stripe_key = 'sk_live_4eC39HqLyjWDarjtT1zdp7dc';\nconst github_token = 'ghp_16C7e42F292c6912E7710c838347Ae178B4a';"></textarea>
                <div class="button-group">
                    <button class="btn-primary" onclick="scanCode()">üîç Scan for Secrets</button>
                    <button class="btn-secondary" onclick="clearAll()">Clear</button>
                </div>
                <p class="keyboard-hint">üí° Tip: Press Ctrl+Enter (or Cmd+Enter on Mac) to scan</p>
                <div class="test-samples">
                    <p style="color: var(--text-2); font-size: 14px; margin-bottom: 8px;">Quick Test Samples:</p>
                    <button class="btn-secondary sample-btn" onclick="loadSample('aws')">AWS Keys</button>
                    <button class="btn-secondary sample-btn" onclick="loadSample('stripe')">Stripe API</button>
                    <button class="btn-secondary sample-btn" onclick="loadSample('github')">GitHub Token</button>
                    <button class="btn-secondary sample-btn" onclick="loadSample('mixed')">Mixed Secrets</button>
                </div>
            </div>

            <div class="card">
                <h2>Detection Patterns</h2>
                <p style="color: var(--text-2); margin-bottom: 16px;">Detects <strong>20+ common secret types</strong> using regex patterns and entropy analysis.</p>
                <div class="pattern-list">
                    <div class="pattern-group">
                        <div class="pattern-group-title"><span class="pattern-group-icon"></span>Cloud Providers</div>
                        <div class="pattern-items">
                            <span class="pattern-tag">AWS Access Keys</span>
                            <span class="pattern-tag">Azure Keys</span>
                            <span class="pattern-tag">Google API Keys</span>
                        </div>
                    </div>
                    <div class="pattern-group">
                        <div class="pattern-group-title"><span class="pattern-group-icon"></span>Payment & Communication</div>
                        <div class="pattern-items">
                            <span class="pattern-tag">Stripe Keys</span>
                            <span class="pattern-tag">SendGrid Keys</span>
                            <span class="pattern-tag">Twilio Keys</span>
                            <span class="pattern-tag">Slack Tokens</span>
                        </div>
                    </div>
                    <div class="pattern-group">
                        <div class="pattern-group-title"><span class="pattern-group-icon"></span>Version Control</div>
                        <div class="pattern-items">
                            <span class="pattern-tag">GitHub Tokens</span>
                            <span class="pattern-tag">GitLab Keys</span>
                        </div>
                    </div>
                    <div class="pattern-group">
                        <div class="pattern-group-title"><span class="pattern-group-icon"></span>Authentication</div>
                        <div class="pattern-items">
                            <span class="pattern-tag">JWT Tokens</span>
                            <span class="pattern-tag">OAuth Tokens</span>
                            <span class="pattern-tag">Bearer Tokens</span>
                        </div>
                    </div>
                    <div class="pattern-group">
                        <div class="pattern-group-title"><span class="pattern-group-icon"></span>Databases & Credentials</div>
                        <div class="pattern-items">
                            <span class="pattern-tag">Database URLs</span>
                            <span class="pattern-tag">Private Keys</span>
                            <span class="pattern-tag">Passwords</span>
                        </div>
                    </div>
                    <div class="pattern-group">
                        <div class="pattern-group-title"><span class="pattern-group-icon"></span>Advanced Detection</div>
                        <div class="pattern-items">
                            <span class="pattern-tag">High Entropy Strings</span>
                            <span class="pattern-tag">Generic API Keys</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Scanning for secrets...</p>
        </div>

        <div class="results-section" id="resultsSection" style="display: none;">
            <div class="result-header">
                <div>
                    <h2 style="margin-bottom: 12px;">Scan Results</h2>
                    <div class="result-stats" id="resultStats"></div>
                </div>
                <div class="result-actions" id="resultActions" style="display: none;">
                    <button class="btn-copy" onclick="copyResults()" id="copyBtn">üìã Copy Results</button>
                </div>
            </div>
            <div id="findingsContainer"></div>
        </div>

        <div class="offline-usage">
            <h3>üì• Use Offline</h3>
            <p style="color: var(--text-2); margin-bottom: 16px;">Runs <strong>completely in your browser</strong> with zero server communication. Download and use offline:</p>
            <ol style="color: var(--text-2); margin-left: 20px; line-height: 1.8;">
                <li>Right-click and "Save As" or Ctrl+S</li>
                <li>Save as <code style="background: var(--bg-3); padding: 2px 6px; border-radius: 3px;">secret-scanner.html</code></li>
                <li>Open in any browser - works completely offline</li>
                <li>Your code never touches a server or network</li>
            </ol>
            <div style="margin-top: 16px; padding: 16px; background: var(--bg-3); border-radius: 8px; border-left: 4px solid var(--accent);">
                <p style="color: var(--text-1); font-weight: 600; margin-bottom: 8px;">üîê Privacy Guarantee</p>
                <p style="color: var(--text-2); font-size: 14px;">No analytics, tracking, or telemetry. Open dev console Network tab - zero outbound requests during scanning.</p>
            </div>
        </div>

        <div class="quickstart">
            <h3>üöÄ QuickStart</h3>
            <div class="quickstart-steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>Paste Your Code</h4>
                        <p>Copy source code, config files, or environment files into the text area.</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>Run Scanner</h4>
                        <p>Click "Scan for Secrets" or press Ctrl+Enter.</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>Review Findings</h4>
                        <p>Each secret shows type, location, and exact match. Use "Copy Results" to share.</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>Fix Issues</h4>
                        <p>Remove hardcoded secrets and use environment variables.</p>
                        <div class="code-block">// ‚ùå Bad - Hardcoded secret
const API_KEY = 'sk_live_abc123xyz789';

// ‚úÖ Good - Environment variable
const API_KEY = process.env.STRIPE_API_KEY;</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Open source ‚Ä¢ <a href="https://github.com/Aren-Garro/shiny-secrets" target="_blank">GitHub</a></p>
            <p style="margin-top: 8px;">Built with ‚ù§Ô∏è for developer security ‚Ä¢ 100% free, no tracking</p>
        </div>
    </div>

    <script src="lib/core.js"></script>
    <script src="lib/browser-scanner.js"></script>
    <script>
        function scanCode() {
            const input = document.getElementById('codeInput').value;
            if (!input.trim()) return alert('Please paste some code to scan!');

            const loading = document.getElementById('loading');
            const results = document.getElementById('resultsSection');
            loading.classList.add('active');
            results.style.display = 'none';

            setTimeout(() => {
                try {
                    displayResults(window.ShinySecretsBrowserScanner.scanInput(input));
                } catch (error) {
                    console.error('Scan error:', error);
                    alert('Scan error occurred.');
                } finally {
                    loading.classList.remove('active');
                }
            }, 300);
        }

        function copyResults() {
            const findings = window.lastFindings || [];
            if (!findings.length) return alert('No results to copy!');

            let text = `Secret Scanner Results\n======================\n\nTotal: ${findings.length}\n\n`;
            findings.forEach((f, i) => {
                text += `${i + 1}. ${f.type}\n   Line: ${f.line}\n   Match: ${f.match}\n`;
                if (f.entropy) text += `   Entropy: ${f.entropy} bits\n`;
                text += `   Code: ${f.content}\n\n`;
            });

            navigator.clipboard.writeText(text).then(() => {
                const btn = document.getElementById('copyBtn');
                btn.textContent = '‚úÖ Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'üìã Copy Results';
                    btn.classList.remove('copied');
                }, 2000);
            }).catch(() => alert('Copy failed.'));
        }

        function displayResults(findings) {
            window.lastFindings = findings;
            const results = document.getElementById('resultsSection');
            const stats = document.getElementById('resultStats');
            const container = document.getElementById('findingsContainer');
            const actions = document.getElementById('resultActions');

            results.style.display = 'block';

            if (!findings.length) {
                stats.innerHTML = '<span class="stat-badge stat-success">‚úì No secrets detected</span>';
                actions.style.display = 'none';
                container.innerHTML = `<div class="no-results"><svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><h3>All Clear!</h3><p>No hardcoded secrets detected.</p></div>`;
                return;
            }

            actions.style.display = 'flex';
            const counts = {
                critical: findings.filter(f => f.severity === 'CRITICAL').length,
                high: findings.filter(f => f.severity === 'HIGH').length,
                medium: findings.filter(f => f.severity === 'MEDIUM').length
            };

            stats.innerHTML = `
                <span class="stat-badge stat-danger">‚ö†Ô∏è ${findings.length} secret${findings.length > 1 ? 's' : ''} found</span>
                ${counts.critical ? `<span class="stat-badge stat-warning">üî• ${counts.critical} critical</span>` : ''}
                ${counts.high ? `<span class="stat-badge stat-warning">‚ö° ${counts.high} high</span>` : ''}
                ${counts.medium ? `<span class="stat-badge" style="background: rgba(56, 189, 248, 0.2); color: var(--accent); border: 1px solid var(--accent);">‚ÑπÔ∏è ${counts.medium} medium</span>` : ''}
            `;

            container.innerHTML = findings.map(f => {
                const esc = text => {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                };
                const match = esc(f.match);
                const content = esc(f.content);
                const highlighted = content.replace(
                    new RegExp(match.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'),
                    `<span class="secret-highlight">${match}</span>`
                );
                const severityClass = `severity-${f.severity.toLowerCase()}`;

                return `<div class="finding"><div class="finding-header"><span class="finding-type">üî¥ ${esc(f.type)}</span><span style="display: flex; align-items: center; gap: 10px;"><span class="severity-badge ${severityClass}">${esc(f.severity)}</span><span class="finding-line">Line ${f.line}</span></span></div><p style="color: var(--text-2); font-size: 13px; margin-bottom: 4px;">${esc(f.description)}</p>${f.entropy ? `<p class="entropy-info">Entropy: ${f.entropy} bits</p>` : ''}<div class="finding-content">${highlighted}</div></div>`;
            }).join('');

            setTimeout(() => results.scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);
        }

        function clearAll() {
            document.getElementById('codeInput').value = '';
            document.getElementById('resultsSection').style.display = 'none';
        }

        function loadSample(type) {
            const samples = {
                aws: `# AWS Config\naws_access_key_id = AKIAIOSFODNN7EXAMPLE\naws_secret_access_key = wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n\nregion = us-east-1`,
                stripe: `// Payment\nconst stripe = require('stripe');\nconst client = stripe('sk_live_4eC39HqLyjWDarjtT1zdp7dc');\n\nconst webhook = 'whsec_test_7Ss8TEwmkHApy5OhZ4x7dEp9';`,
                github: `# GitHub Actions\nenv:\n  TOKEN: ghp_16C7e42F292c6912E7710c838347Ae178B4a\n  OAUTH: gho_qJaIv5WLZxUfIvvxqJYLKh4t09o2U3A0Test`,
                mixed: `const config = {\n  google: 'AIzaSyDaGmWKa4JsXZ-HjGw7ISLn_3namBGewQe',\n  slack: 'xoxb-123456789012-1234567890123-4ut0m4t10nt35tt0k3n',\n  db: 'postgresql://admin:SuperSecret123@db.example.com:5432/mydb',\n  jwt: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIn0.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c'\n};`
            };
            document.getElementById('codeInput').value = samples[type] || '';
        }

        document.addEventListener('DOMContentLoaded', () => {
            const textarea = document.getElementById('codeInput');
            textarea.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    scanCode();
                }
            });
            textarea.focus();
        });
    </script>
</body>
</html>
